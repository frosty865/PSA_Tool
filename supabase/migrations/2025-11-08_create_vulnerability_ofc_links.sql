-- ==========================================================
-- VOFC Engine: Vulnerability–OFC Link Table
-- Purpose:
--   Store explicit relationships between vulnerabilities
--   and their corresponding Options for Consideration (OFCs)
-- ==========================================================

CREATE TABLE IF NOT EXISTS vulnerability_ofc_links (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    vulnerability_text TEXT NOT NULL,
    ofc_text TEXT NOT NULL,
    vulnerability_conf NUMERIC(4,3),
    ofc_conf NUMERIC(4,3),
    category TEXT,
    discipline TEXT,
    model_version TEXT,
    source_submission UUID,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

COMMENT ON TABLE vulnerability_ofc_links IS
'Stores linked vulnerability–OFC pairs produced by Phase 3 Auditor.';

CREATE INDEX IF NOT EXISTS idx_vuln_ofc_links_model_version
  ON vulnerability_ofc_links (model_version);

CREATE INDEX IF NOT EXISTS idx_vuln_ofc_links_created_at
  ON vulnerability_ofc_links (created_at);

